{
	"debug": false,
	"vars": {},
	"conditions": {
		"check-event-type": "'${headers.event-type}'.includes('Powerwall measurement')",
		"check-event-source": "'${headers.user-agent}'.includes('Telegraf')",
		"check-array-item": "'${headers.reprocess_key}'.includes('split-bulk-array')",
		"check-measurement-type": "'${body.name}' === 'alerts'",
		"check-grid-not-connected": "${body.fields.SystemConnectedToGrid} != 1",
		"enabled": "true"
	},
	"actions": {
		"01 - action-tag": { 
			"type": "tag", 
			"value": "alert - grid not connected",
			"_expire": 60
		},
		"02 - action-set-var home.upstairs": { 
			"type": "set", 
			"name": "ALERT--${headers.powerwall}--grid-down",
			"value": "${body.fields.SystemConnectedToGrid}"
		}
	}
}
