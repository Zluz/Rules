{
	"debug": false,
	"conditions": {
		"check-event-type": "'${headers.event-type}'.includes('Powerwall measurement')",
		"check-event-source": "'${headers.user-agent}'.includes('Telegraf')",
		"check-array-item": "'${headers.reprocess_key}'.includes('split-bulk-array')",
		"check-measurement-type": "'${body.name}' === 'http'",
		"enabled": "true"
	},
	"actions": {
		"01 - action-tag": { 
			"type": "tag", 
			"value": "set - PW http",
			"expire": -1
		},
		"02 - action-set-var home.upstairs": { 
			"type": "set", 
			"name": "Home",
			"path": "$.batteries.${headers.powerwall}.http",
			"value": "${headers.powerwall}",
			"add": {
			    "percentage": "${body.fields.percentage}"
			}
		}
	}
}

